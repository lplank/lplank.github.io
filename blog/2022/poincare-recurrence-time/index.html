<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Poincaré recurrence time in cellular automata | pplank8</title> <meta name="author" content="pplank8 "/> <meta name="description" content="Exploring the asimptotical behavior of CA"/> <meta name="keywords" content="computation, philosophy, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://pplank8.github.io/blog/2022/poincare-recurrence-time/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> <script src="/assets/js/o3dv/o3dv.min.js"></script> <script>OV.SetExternalLibLocation("libs"),OV.Init3DViewerElements();</script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">pplank8</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/code/">code</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-2"> <div class="post"> <header class="post-header"> <h1 class="post-title">Poincaré recurrence time in cellular automata</h1> <p class="post-meta">October 27, 2022</p> <p class="post-tags"> <a href="/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a>   ·   <a href="/blog/tag/computation"> <i class="fas fa-hashtag fa-sm"></i> computation</a>   <a href="/blog/tag/automata"> <i class="fas fa-hashtag fa-sm"></i> automata</a>   </p> </header> <article class="post-content"> <p>From wikipedia:</p> <blockquote> <p>The Poincaré recurrence theorem states that certain dynamical systems will, after a sufficiently long but finite time, return to a state arbitrarily close to (for continuous state systems), or exactly the same as (for discrete state systems), their initial state.</p> <p>The Poincaré recurrence time is the length of time elapsed until the recurrence. This time may vary greatly depending on the exact initial state and required degree of closeness.</p> </blockquote> <p>Cellular automata are clearly discrete system. We can measure the Poincaré recurrence (PR) time in terms of steps (we can consider 1 step equivalent to 1 unit of time). It’s enough to check if at any given step we enter in a state already seen. It’s necessary to store each state seen (an entry in a dictionary) and check for evaluation.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">import_ipynb</span>
<span class="kn">from</span> <span class="nn">automata_generation</span> <span class="kn">import</span> <span class="n">generate</span><span class="p">,</span> <span class="n">plot_run</span><span class="p">,</span> <span class="n">make_columns</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>importing Jupyter notebook from automata_generation.ipynb
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">find_recurrence</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">steps</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">tobytes</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">i</span><span class="o">-</span><span class="n">steps</span><span class="p">[</span><span class="n">row</span><span class="p">]</span>
        <span class="n">steps</span><span class="p">[</span><span class="n">row</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">plot_recurrence_upperbound</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">step_limit</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">empty</span><span class="p">(</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ub</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">steps</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">ub</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">generate</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">step_limit</span><span class="p">,</span> <span class="n">test_recurrence</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">exit_on_recurrence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="o">!=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">steps</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="p">.</span><span class="n">log2</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">steps</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">return</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">steps</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="p">,</span> <span class="n">recurrence_indices</span> <span class="o">=</span> <span class="n">generate</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">test_recurrence</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">exit_on_recurrence</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">find_recurrence</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">plot_recurrence_match</span><span class="p">(</span><span class="n">recurrence_indices</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">recurrence_indices</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"recurrence was not found"</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="n">x</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">recurrence_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span><span class="n">recurrence_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">][:],</span>
            <span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))],</span>
            <span class="n">x</span><span class="p">[</span><span class="n">recurrence_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="n">recurrence_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)][:]</span>
        <span class="p">),</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plot_run</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot_recurrence_match</span><span class="p">(</span><span class="n">recurrence_indices</span><span class="p">)</span>
</code></pre></div></div> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_8_0-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_8_0-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_8_0-1400.webp"></source> <img src="/assets/img/posts/prt_files/poincare-recurrence-time_8_0.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>It could be interesting to see poincare recurrence for each rule. Let’s calculate the PR for each rule, with size in $[1…K]$ and a maximum number of step N and see what kind of trend we get for each rule.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">time</span>

<span class="n">colorize</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s">'red'</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="s">'green'</span><span class="p">)</span>
<span class="n">execution_time</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">step_limit</span> <span class="o">=</span> <span class="mi">20000</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">):</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'rule </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">xs</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">steps</span> <span class="o">=</span> <span class="n">plot_recurrence_upperbound</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">step_limit</span><span class="o">=</span><span class="n">step_limit</span><span class="p">)</span>
        <span class="n">end</span> <span class="o">=</span>  <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">execution_time</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="p">,</span> <span class="n">r</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="p">,</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
        <span class="c1">#plt.rcParams["figure.figsize"]=10,10
</span>        <span class="c1">#plt.plot(xs, ub)
</span>        <span class="c1">#plt.scatter(xs, steps, marker='.', c=colorize(steps))
</span>        <span class="c1">#plt.show()
</span>        <span class="c1">#plt.savefig(f"rule-{r}_{step_limit}steps.png")
</span><span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"aborted"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

<span class="n">execution_time</span><span class="p">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">execution_time</span><span class="p">[:</span><span class="mi">20</span><span class="p">]:</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"rule</span><span class="si">{</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s"> took </span><span class="si">{</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rule 0
	 0.014295816421508789
rule 1
	 0.014110088348388672
rule 2
	 0.06731963157653809
rule 3
	 0.13080883026123047
rule 4
	 0.009865045547485352
rule 5
	 0.010412931442260742
rule 6
	 0.08333683013916016
rule 7
	 0.011668920516967773
rule 8
	 0.007643938064575195
rule 9
	 0.09536623954772949
rule 10
	 0.06816911697387695
rule 11
	 0.09696221351623535
rule 12
	 0.011855125427246094
rule 13
	 0.05993509292602539
rule 14
	 0.06050300598144531
rule 15
	 0.08336710929870605
rule 16
	 0.05897998809814453
rule 17
	 0.11812114715576172
rule 18
	 0.6909589767456055
rule 19
	 0.014127016067504883
rule 20
	 0.0891580581665039
rule 21
	 0.013031959533691406
rule 22
	 0.09264206886291504
rule 23
	 0.018725872039794922
rule 24
	 0.0650792121887207
rule 25
	 0.14934778213500977
rule 26
	 0.97776198387146
rule 27
	 0.1139979362487793
rule 28
	 0.054821014404296875
rule 29
	 0.011471986770629883
rule 30
	 26.5013108253479
rule 31
	 0.019721031188964844
rule 32
	 0.013998746871948242
rule 33
	 0.01690983772277832
rule 34
	 0.10316276550292969
rule 35
	 0.23908495903015137
rule 36
	 0.016974687576293945
rule 37
	 0.04945206642150879
rule 38
	 0.16737580299377441
rule 39
	 0.20819401741027832
rule 40
	 0.015106916427612305
rule 41
	 0.2780458927154541
rule 42
	 0.10079574584960938
rule 43
	 0.15611600875854492
rule 44
	 0.014432191848754883
rule 45
	 29.741049766540527
rule 46
	 0.06091904640197754
rule 47
	 0.08320116996765137
rule 48
	 0.05670809745788574
rule 49
	 0.11656785011291504
rule 50
	 0.031477928161621094
rule 51
	 0.00950002670288086
rule 52
	 0.08253312110900879
rule 53
	 0.11395692825317383
rule 54
	 0.041037797927856445
rule 55
	 0.009826183319091797
rule 56
	 0.06255269050598145
rule 57
	 0.10928201675415039
rule 58
	 0.061155080795288086
rule 59
	 0.10793924331665039
rule 60
	 8.379151105880737
rule 61
	 0.12112307548522949
rule 62
	 0.0664830207824707
rule 63
	 0.010135173797607422
rule 64
	 0.008372068405151367
rule 65
	 0.09740424156188965
rule 66
	 0.06685113906860352
rule 67
	 0.11491107940673828
rule 68
	 0.007071018218994141
rule 69
	 0.05895090103149414
rule 70
	 0.05468010902404785
rule 71
	 0.010773181915283203
rule 72
	 0.008522987365722656
rule 73
	 0.2297210693359375
rule 74
	 0.06133317947387695
rule 75
	 31.90888786315918
rule 76
	 0.008646249771118164
rule 77
	 0.029652833938598633
rule 78
	 0.05922889709472656
rule 79
	 0.05463671684265137
rule 80
	 0.06371021270751953
rule 81
	 0.09065103530883789
rule 82
	 0.9790999889373779
rule 83
	 0.11075472831726074
rule 84
	 0.06128096580505371
rule 85
	 0.12448692321777344
rule 86
	 26.123712062835693
rule 87
	 0.012782096862792969
rule 88
	 0.05713701248168945
rule 89
	 30.4510018825531
rule 90
	 4.750530004501343
rule 91
	 0.015636920928955078
rule 92
	 0.06093168258666992
rule 93
	 0.06131482124328613
rule 94
	 0.03467392921447754
rule 95
	 0.011383056640625
rule 96
	 0.008281230926513672
rule 97
	 0.16131186485290527
rule 98
	 0.06476068496704102
rule 99
	 0.09926390647888184
rule 100
	 0.010210990905761719
rule 101
	 29.457420825958252
rule 102
	 8.820180892944336
rule 103
	 0.11405014991760254
rule 104
	 0.007352113723754883
rule 105
	 6.224099159240723
rule 106
	 0.11618804931640625
rule 107
	 0.3177459239959717
rule 108
	 0.0222320556640625
rule 109
	 0.23206615447998047
rule 110
	 1.3274178504943848
rule 111
	 0.10014700889587402
rule 112
	 0.062280893325805664
rule 113
	 0.11414384841918945
rule 114
	 0.07397580146789551
rule 115
	 0.11969828605651855
rule 116
	 0.06546783447265625
rule 117
	 0.092742919921875
rule 118
	 0.0684971809387207
rule 119
	 0.010839223861694336
rule 120
	 0.07424807548522949
rule 121
	 0.17499327659606934
rule 122
	 0.40232205390930176
rule 123
	 0.01334381103515625
rule 124
	 1.1915581226348877
rule 125
	 0.10111403465270996
rule 126
	 0.742887020111084
rule 127
	 0.013633012771606445
rule 128
	 0.011010169982910156
rule 129
	 0.7216980457305908
rule 130
	 0.07665300369262695
rule 131
	 0.08456707000732422
rule 132
	 0.008452177047729492
rule 133
	 0.05306386947631836
rule 134
	 0.09484601020812988
rule 135
	 26.81414794921875
rule 136
	 0.00937199592590332
rule 137
	 1.0686559677124023
rule 138
	 0.0604400634765625
rule 139
	 0.05618906021118164
rule 140
	 0.007270097732543945
rule 141
	 0.052774906158447266
rule 142
	 0.06703519821166992
rule 143
	 0.06638312339782715
rule 144
	 0.05845022201538086
rule 145
	 0.07192397117614746
rule 146
	 0.6040017604827881
rule 147
	 0.0495760440826416
rule 148
	 0.09687376022338867
rule 149
	 28.464774131774902
rule 150
	 5.020642042160034
rule 151
	 0.008892059326171875
rule 152
	 0.06734585762023926
rule 153
	 9.347355127334595
rule 154
	 1.0050771236419678
rule 155
	 0.08692622184753418
rule 156
	 0.06453824043273926
rule 157
	 0.07854413986206055
rule 158
	 0.11428189277648926
rule 159
	 0.009076118469238281
rule 160
	 0.008481979370117188
rule 161
	 0.7498009204864502
rule 162
	 0.05953097343444824
rule 163
	 0.08424711227416992
rule 164
	 0.0076100826263427734
rule 165
	 4.555773973464966
rule 166
	 0.10415410995483398
rule 167
	 1.0875978469848633
rule 168
	 0.008850812911987305
rule 169
	 22.293861865997314
rule 170
	 0.06535601615905762
rule 171
	 0.060491085052490234
rule 172
	 0.008649110794067383
rule 173
	 0.05925178527832031
rule 174
	 0.06543493270874023
rule 175
	 0.05765032768249512
rule 176
	 0.06086015701293945
rule 177
	 0.08470869064331055
rule 178
	 0.043411970138549805
rule 179
	 0.03549790382385254
rule 180
	 0.09203505516052246
rule 181
	 0.9599258899688721
rule 182
	 0.6476240158081055
rule 183
	 0.00801396369934082
rule 184
	 0.06304502487182617
rule 185
	 0.06536316871643066
rule 186
	 0.058175086975097656
rule 187
	 0.06926488876342773
rule 188
	 0.1292402744293213
rule 189
	 0.062432050704956055
rule 190
	 0.07839202880859375
rule 191
	 0.012982845306396484
rule 192
	 0.00967097282409668
rule 193
	 1.0988030433654785
rule 194
	 0.06521081924438477
rule 195
	 9.893154859542847
rule 196
	 0.008414983749389648
rule 197
	 0.05427098274230957
rule 198
	 0.05717802047729492
rule 199
	 0.055357933044433594
rule 200
	 0.0076580047607421875
rule 201
	 0.012023210525512695
rule 202
	 0.06798315048217773
rule 203
	 0.01167607307434082
rule 204
	 0.0077970027923583984
rule 205
	 0.008475065231323242
rule 206
	 0.05967307090759277
rule 207
	 0.008154869079589844
rule 208
	 0.06399059295654297
rule 209
	 0.06505799293518066
rule 210
	 1.040682315826416
rule 211
	 0.08469080924987793
rule 212
	 0.061270713806152344
rule 213
	 0.07012605667114258
rule 214
	 0.1096339225769043
rule 215
	 0.01001286506652832
rule 216
	 0.06030988693237305
rule 217
	 0.009869813919067383
rule 218
	 0.29715800285339355
rule 219
	 0.013760089874267578
rule 220
	 0.058279991149902344
rule 221
	 0.010712146759033203
rule 222
	 0.03295779228210449
rule 223
	 0.01018214225769043
rule 224
	 0.00860595703125
rule 225
	 19.760647296905518
rule 226
	 0.06753420829772949
rule 227
	 0.07141613960266113
rule 228
	 0.009190082550048828
rule 229
	 0.06753706932067871
rule 230
	 0.12091898918151855
rule 231
	 0.059455156326293945
rule 232
	 0.00868082046508789
rule 233
	 0.016736984252929688
rule 234
	 0.07507705688476562
rule 235
	 0.015402078628540039
rule 236
	 0.010314226150512695
rule 237
	 0.011841058731079102
rule 238
	 0.0683908462524414
rule 239
	 0.012744903564453125
rule 240
	 0.06637382507324219
rule 241
	 0.06178689002990723
rule 242
	 0.060775041580200195
rule 243
	 0.06935501098632812
rule 244
	 0.07609987258911133
rule 245
	 0.11420083045959473
rule 246
	 0.09661698341369629
rule 247
	 0.009140968322753906
rule 248
	 0.08502388000488281
rule 249
	 0.013747930526733398
rule 250
	 0.05302023887634277
rule 251
	 0.012362957000732422
rule 252
	 0.07380986213684082
rule 253
	 0.011536121368408203
rule 254
	 0.03669404983520508
rule 255
	 0.008320093154907227
rule75 took 31.90888786315918
rule89 took 30.4510018825531
rule45 took 29.741049766540527
rule101 took 29.457420825958252
rule149 took 28.464774131774902
rule135 took 26.81414794921875
rule30 took 26.5013108253479
rule86 took 26.123712062835693
rule169 took 22.293861865997314
rule225 took 19.760647296905518
rule195 took 9.893154859542847
rule153 took 9.347355127334595
rule102 took 8.820180892944336
rule60 took 8.379151105880737
rule105 took 6.224099159240723
rule150 took 5.020642042160034
rule90 took 4.750530004501343
rule165 took 4.555773973464966
rule110 took 1.3274178504943848
rule124 took 1.1915581226348877



&lt;Figure size 640x480 with 0 Axes&gt;
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">time_only</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">execution_time</span><span class="p">]</span>
<span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">time_only</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"histogram"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_11_0-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_11_0-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_11_0-1400.webp"></source> <img src="/assets/img/posts/prt_files/poincare-recurrence-time_11_0.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>For the great majority of rules the PRT is almost constant up to size 50, so let’s just investigate the rules for which \(PRT &gt; 20\). Those would be</p> <ul> <li>rule75</li> <li>rule89</li> <li>rule45</li> <li>rule101</li> <li>rule149</li> <li>rule135</li> <li>rule30</li> <li>rule86</li> <li>rule169</li> <li>rule225</li> <li>rule195</li> </ul> <p>Let’s plot them</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">width</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">width</span><span class="p">))</span>
<span class="n">rules</span> <span class="o">=</span> <span class="p">[</span><span class="mi">75</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">149</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">195</span><span class="p">]</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">rules</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">generate</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">width</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">width</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_axis_off</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">'none'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">binary</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">rule</span><span class="si">}</span><span class="s"> - </span><span class="si">{</span><span class="nb">bin</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">,</span> <span class="n">fontdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">'fontsize'</span><span class="p">:</span><span class="mi">70</span><span class="p">})</span>
</code></pre></div></div> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_13_0-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_13_0-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_13_0-1400.webp"></source> <img src="/assets/img/posts/prt_files/poincare-recurrence-time_13_0.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Interestingly enough each pair can be considered as a single rule as the rules in each pair are simmetrical. While the first 8 rules have a similar behavior, showing a clear pattern, the last two rules are very different from the other. Let’s run them for a while and see if there is a pattern there.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#rule60 took 8.85617208480835
#rule195 took 8.831139087677002
#rule102 took 8.81187391281128
#rule153 took 8.585221767425537
</span>
<span class="c1">#rule105 took 5.552289962768555
#rule150 took 4.471593856811523
#rule165 took 4.46081280708313
#rule90 took 4.451854705810547
</span>
<span class="n">rule</span> <span class="o">=</span> <span class="mi">169</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">steps</span> <span class="o">=</span> <span class="mi">40000</span>
<span class="n">data</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">generate</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">test_recurrence</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">exit_on_recurrence</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">parts</span> <span class="o">=</span> <span class="n">make_columns</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plot_run</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>
</code></pre></div></div> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_16_0-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_16_0-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_16_0-1400.webp"></source> <img src="/assets/img/posts/prt_files/poincare-recurrence-time_16_0.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rule</span> <span class="o">=</span> <span class="mi">110</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">steps</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">data110</span><span class="p">,</span> <span class="n">rec_indices</span> <span class="o">=</span> <span class="n">generate</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">test_recurrence</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">exit_on_recurrence</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">rec_indices</span><span class="p">)</span>
<span class="n">parts</span> <span class="o">=</span> <span class="n">make_columns</span><span class="p">(</span><span class="n">data110</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plot_run</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(-1, -1)
</code></pre></div></div> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_17_1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_17_1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_17_1-1400.webp"></source> <img src="/assets/img/posts/prt_files/poincare-recurrence-time_17_1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rule</span> <span class="o">=</span> <span class="mi">122</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">steps</span> <span class="o">=</span> <span class="mi">200_000</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
<span class="n">start</span><span class="p">[</span><span class="mi">45</span><span class="p">:</span><span class="mi">55</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">data122</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">generate</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">test_recurrence</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">exit_on_recurrence</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">with_init</span><span class="o">=</span><span class="n">start</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">parts</span> <span class="o">=</span> <span class="n">make_columns</span><span class="p">(</span><span class="n">data122</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plot_run</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>
</code></pre></div></div> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_19_0-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_19_0-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_19_0-1400.webp"></source> <img src="/assets/img/posts/prt_files/poincare-recurrence-time_19_0.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rule</span> <span class="o">=</span> <span class="mi">122</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">steps</span> <span class="o">=</span> <span class="mi">20_00</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
<span class="n">start</span><span class="p">[</span><span class="mi">45</span><span class="p">:</span><span class="mi">55</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">data122_closeup</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">generate</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">with_init</span><span class="o">=</span><span class="n">start</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">make_columns</span><span class="p">(</span><span class="n">data122_closeup</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plot_run</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</code></pre></div></div> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_21_0-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_21_0-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_21_0-1400.webp"></source> <img src="/assets/img/posts/prt_files/poincare-recurrence-time_21_0.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot_run</span><span class="p">(</span><span class="n">data122_closeup</span><span class="p">[:</span><span class="mi">100</span><span class="p">])</span>
</code></pre></div></div> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_22_0-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_22_0-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/prt_files/poincare-recurrence-time_22_0-1400.webp"></source> <img src="/assets/img/posts/prt_files/poincare-recurrence-time_22_0.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </article> </div> </div> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>